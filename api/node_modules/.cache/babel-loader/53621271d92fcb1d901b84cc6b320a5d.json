{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n// Adapted from https://gist.github.com/calvinmetcalf/91e8e84dc63c75f2aa53\nimport { bnToU8a, u8aConcat } from '@polkadot/util';\nimport { hmacSha512 } from \"../hmac/index.js\";\nexport function pbkdf2Sync(password, salt, rounds) {\n  var len = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 64;\n  var out = new Uint8Array();\n  var num = 0;\n  var block = u8aConcat(salt, new Uint8Array(4));\n\n  while (out.length < len) {\n    num++;\n    block.set(bnToU8a(num, {\n      bitLength: 32,\n      isLe: false\n    }), salt.length);\n    var prev = hmacSha512(password, block);\n    var md = prev;\n    var i = 0;\n\n    while (++i < rounds) {\n      prev = hmacSha512(password, prev);\n      var j = -1;\n\n      while (++j < prev.length) {\n        md[j] ^= prev[j];\n      }\n    }\n\n    out = u8aConcat(out, md);\n  }\n\n  return out.slice(0, len);\n}","map":null,"metadata":{},"sourceType":"module"}