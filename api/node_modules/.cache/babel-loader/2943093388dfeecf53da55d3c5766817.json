{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { u8aConcat } from '@polkadot/util';\nimport { naclEncrypt } from \"../nacl/index.js\";\nimport { scryptEncode, scryptToU8a } from \"../scrypt/index.js\";\nimport { jsonEncryptFormat } from \"./encryptFormat.js\";\nexport function jsonEncrypt(data, contentType, passphrase) {\n  var isEncrypted = false;\n  var encoded = data;\n\n  if (passphrase) {\n    var _scryptEncode = scryptEncode(passphrase),\n        params = _scryptEncode.params,\n        password = _scryptEncode.password,\n        salt = _scryptEncode.salt;\n\n    var _naclEncrypt = naclEncrypt(encoded, password.subarray(0, 32)),\n        encrypted = _naclEncrypt.encrypted,\n        nonce = _naclEncrypt.nonce;\n\n    isEncrypted = true;\n    encoded = u8aConcat(scryptToU8a(salt, params), nonce, encrypted);\n  }\n\n  return jsonEncryptFormat(encoded, contentType, isEncrypted);\n}","map":null,"metadata":{},"sourceType":"module"}