{"ast":null,"code":"import _slicedToArray from \"/Users/michaelhuntington/Documents/GitHub/nft-collectibles-wallet/api/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { combineLatest, of } from '@polkadot/x-rxjs';\nimport { map, switchMap } from '@polkadot/x-rxjs/operators';\nimport { memo } from \"../util/index.js\";\nexport function nextElected(instanceId, api) {\n  return memo(instanceId, function () {\n    return api.query.staking.erasStakers ? api.derive.session.indexes().pipe( // only populate for next era in the last session, so track both here - entries are not\n    // subscriptions, so we need a trigger - currentIndex acts as that trigger to refresh\n    switchMap(function (_ref) {\n      var currentEra = _ref.currentEra;\n      return api.query.staking.erasStakers.keys(currentEra);\n    }), map(function (keys) {\n      return keys.map(function (_ref2) {\n        var _ref2$args = _slicedToArray(_ref2.args, 2),\n            accountId = _ref2$args[1];\n\n        return accountId;\n      });\n    })) : api.query.staking.currentElected();\n  });\n}\n/**\n * @description Retrieve latest list of validators\n */\n\nexport function validators(instanceId, api) {\n  return memo(instanceId, function () {\n    return (// Sadly the node-template is (for some obscure reason) not comprehensive, so while the derive works\n      // in all actual real-world deployed chains, it does create some confusion for limited template chains\n      combineLatest([api.query.session ? api.query.session.validators() : of([]), api.query.staking ? api.derive.staking.nextElected() : of([])]).pipe(map(function (_ref3) {\n        var _ref4 = _slicedToArray(_ref3, 2),\n            validators = _ref4[0],\n            nextElected = _ref4[1];\n\n        return {\n          nextElected: nextElected.length ? nextElected : validators,\n          validators: validators\n        };\n      }))\n    );\n  });\n}","map":null,"metadata":{},"sourceType":"module"}