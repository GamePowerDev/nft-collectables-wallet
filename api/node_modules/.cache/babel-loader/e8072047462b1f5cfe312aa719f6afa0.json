{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { BN_EIGHT, bnToU8a, u8aConcat, u8aToBn } from '@polkadot/util';\nimport { hmacSha512 } from \"../../hmac/index.js\"; // performs hard-only derivation on the xprv\n\nexport function ledgerDerivePrivate(xprv, index) {\n  var kl = xprv.subarray(0, 32);\n  var kr = xprv.subarray(32, 64);\n  var cc = xprv.subarray(64, 96);\n  var data = u8aConcat([0], kl, kr, bnToU8a(index, {\n    bitLength: 32,\n    isLe: true\n  }));\n  var z = hmacSha512(cc, data);\n  data[0] = 0x01;\n  return u8aConcat(bnToU8a(u8aToBn(kl, {\n    isLe: true\n  }).iadd(u8aToBn(z.subarray(0, 28), {\n    isLe: true\n  }).imul(BN_EIGHT)), {\n    bitLength: 512,\n    isLe: true\n  }).subarray(0, 32), bnToU8a(u8aToBn(kr, {\n    isLe: true\n  }).iadd(u8aToBn(z.subarray(32, 64), {\n    isLe: true\n  })), {\n    bitLength: 512,\n    isLe: true\n  }).subarray(0, 32), hmacSha512(cc, data).subarray(32, 64));\n}","map":null,"metadata":{},"sourceType":"module"}