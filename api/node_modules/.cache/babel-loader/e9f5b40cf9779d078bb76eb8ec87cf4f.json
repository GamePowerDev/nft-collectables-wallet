{"ast":null,"code":"// Copyright 2017-2021 @polkadot/util-crypto authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport nacl from 'tweetnacl';\nimport { randomAsU8a } from \"../random/asU8a.js\";\n/**\n * @name naclSeal\n * @summary Seals a message using the sender's encrypting secretKey, receiver's public key, and nonce\n * @description\n * Returns an encrypted message which can be open only by receiver's secretKey. If the `nonce` was not supplied, a random value is generated.\n * @example\n * <BR>\n *\n * ```javascript\n * import { naclEncrypt } from '@polkadot/util-crypto';\n *\n * naclSeal([...], [...], [...], [...]); // => [...]\n * ```\n */\n\nexport function naclSeal(message, senderBoxSecret, receiverBoxPublic) {\n  var nonce = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : randomAsU8a(24);\n  return {\n    nonce: nonce,\n    sealed: nacl.box(message, nonce, receiverBoxPublic, senderBoxSecret)\n  };\n}","map":null,"metadata":{},"sourceType":"module"}