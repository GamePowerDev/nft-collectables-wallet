{"ast":null,"code":"import _slicedToArray from \"/Users/michaelhuntington/Documents/GitHub/nft-collectibles-wallet/api/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n// Copyright 2017-2021 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nimport { combineLatest, of } from '@polkadot/x-rxjs';\nimport { map, switchMap } from '@polkadot/x-rxjs/operators';\nimport { memo } from \"../util/index.js\";\n\nfunction extractsIds(stashId, queuedKeys, nextKeys) {\n  var sessionIds = (queuedKeys.find(function (_ref) {\n    var _ref2 = _slicedToArray(_ref, 1),\n        currentId = _ref2[0];\n\n    return currentId.eq(stashId);\n  }) || [undefined, []])[1];\n  var nextSessionIds = nextKeys.unwrapOr([]);\n  return {\n    nextSessionIds: nextSessionIds,\n    sessionIds: sessionIds\n  };\n}\n\nexport function keys(instanceId, api) {\n  return memo(instanceId, function (stashId) {\n    return api.derive.staking.keysMulti([stashId]).pipe(map(function (_ref3) {\n      var _ref4 = _slicedToArray(_ref3, 1),\n          first = _ref4[0];\n\n      return first;\n    }));\n  });\n}\nexport function keysMulti(instanceId, api) {\n  return memo(instanceId, function (stashIds) {\n    return stashIds.length ? api.query.session.queuedKeys().pipe(switchMap(function (queuedKeys) {\n      var _api$consts$session;\n\n      return combineLatest([of(queuedKeys), (_api$consts$session = api.consts.session) !== null && _api$consts$session !== void 0 && _api$consts$session.dedupKeyPrefix ? api.query.session.nextKeys.multi(stashIds.map(function (stashId) {\n        return [api.consts.session.dedupKeyPrefix, stashId];\n      })) : api.query.session.nextKeys.multi(stashIds)]);\n    }), map(function (_ref5) {\n      var _ref6 = _slicedToArray(_ref5, 2),\n          queuedKeys = _ref6[0],\n          nextKeys = _ref6[1];\n\n      return stashIds.map(function (stashId, index) {\n        return extractsIds(stashId, queuedKeys, nextKeys[index]);\n      });\n    })) : of([]);\n  });\n}","map":null,"metadata":{},"sourceType":"module"}